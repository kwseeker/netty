<mxfile host="Electron" modified="2024-04-21T08:27:29.594Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="iamfyLurelwYvPd98p9A" version="21.6.5" type="device" pages="3">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Java NIO 工作流程">
    <mxGraphModel dx="4261" dy="1598" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="8LeemYQ3Dip39AOmkqmU-55" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-42" target="_Ud4IvRuXKHlU2RU2Mxn-20" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="400" y="2080" />
              <mxPoint x="400" y="1300" />
              <mxPoint x="210" y="1300" />
              <mxPoint x="210" y="1070" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-5" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-3" target="_Ud4IvRuXKHlU2RU2Mxn-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-7" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-3" target="_Ud4IvRuXKHlU2RU2Mxn-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-3" value="1 创建服务端ServerSocketChannel&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是创建服务端Socket FD&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="250" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-0" value="&lt;h1&gt;Java NIO 工作原理（JDK8）&lt;br&gt;&lt;/h1&gt;&lt;p&gt;前置知识：&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Java Socket 编程、Java Net&lt;/li&gt;&lt;li&gt;Linux C 网络编程（socket、select\poll\epoll）、C语言内存对齐规则&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="19" width="640" height="161" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;curved=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-1" target="WIyWlLk6GJQsqaUBKTNV-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-1" value="服务端" style="ellipse;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="80" y="180" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-9" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-4" target="_Ud4IvRuXKHlU2RU2Mxn-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-11" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-4" target="_Ud4IvRuXKHlU2RU2Mxn-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-4" value="2 适配ServerSocketChannel的方法为ServerSocket的方法，并绑定端口&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是将前面的Socket FD绑定为被动Socket FD&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="20" y="430" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-61" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-6" target="_Ud4IvRuXKHlU2RU2Mxn-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-6" value="ServerSocketChannel serverSocket = ServerSocketChannel.open()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;只是创建了文件描述符和SelectorProvider实例&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="250" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-72" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-8" target="_Ud4IvRuXKHlU2RU2Mxn-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-8" value="serverSocket.socket().bind(new InetSocketAddress(9000))" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="440" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-13" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-10" target="_Ud4IvRuXKHlU2RU2Mxn-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-17" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-10" target="_Ud4IvRuXKHlU2RU2Mxn-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-10" value="ServerSocket配置" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="710" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-15" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-12" target="_Ud4IvRuXKHlU2RU2Mxn-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-19" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-12" target="_Ud4IvRuXKHlU2RU2Mxn-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-12" value="3 创建多路复用器 Selector&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是创建epoll FD并监听&lt;br&gt;管道的读端fd EPOLLIN事件&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="790" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-21" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-14" target="_Ud4IvRuXKHlU2RU2Mxn-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-23" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-14" target="_Ud4IvRuXKHlU2RU2Mxn-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-14" value="4 把ServerSocketChannel注册到selector, selector监听accept事件&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;将Socket FD及关注的事件记录到&lt;b&gt;EPollSelectorImpl&lt;/b&gt;的容器中&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="20" y="1020" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-96" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-16" target="_Ud4IvRuXKHlU2RU2Mxn-95" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-16" value="serverSocket&lt;br&gt;.configureBlocking(false)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;改为非阻塞模式，&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;nonBlocking = false&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="710" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-99" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-18" target="_Ud4IvRuXKHlU2RU2Mxn-98" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-18" value="Selector selector = Selector.open()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;这里Selector本质就是epoll底层接口的封装&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="790" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-21" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-20" target="vMLwcvEIQ6NcWGhzbUon-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-20" value="SelectionKey selectionKey = serverSocket.register(selector, SelectionKey.OP_ACCEPT)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;这里并没有执行epoll_ctl只是做了下记录，后面在select()方法中才执行添加监听&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="1010" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-25" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-22" target="_Ud4IvRuXKHlU2RU2Mxn-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-22" value="&lt;font color=&quot;#007fff&quot;&gt;while(true) start&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#fad7ac;strokeColor=#b46504;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="1320" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-28" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-24" target="_Ud4IvRuXKHlU2RU2Mxn-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-51" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-24" target="vMLwcvEIQ6NcWGhzbUon-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-24" value="selector.select()&lt;br&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;注册新增的监听（启动时注册服务端Socket FD OP_ACCEPT 事件也是在这里完成 ）&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;阻塞等待连接事件发生&lt;/font&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="100" y="1372.5" width="200" height="55" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-26" value="&lt;font color=&quot;#007fff&quot;&gt;while end&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#fad7ac;strokeColor=#b46504;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="2280" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-30" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-27" target="_Ud4IvRuXKHlU2RU2Mxn-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-27" value="Set&amp;lt;SelectionKey&amp;gt; selectionKeys = selector.selectedKeys()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;select()方法中触发事件后将触发事件的SelectionKey都记录到了selectedKeys&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="100" y="1460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-34" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-29" target="_Ud4IvRuXKHlU2RU2Mxn-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-29" value="&lt;font color=&quot;#007fff&quot;&gt;selectedKeys遍历 start&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="120" y="1540" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-59" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-31" target="_Ud4IvRuXKHlU2RU2Mxn-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-31" value="&lt;font color=&quot;#007fff&quot;&gt;selectionKeys遍历 end&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="120" y="2220" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-36" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-33" target="_Ud4IvRuXKHlU2RU2Mxn-44" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="1760" as="targetPoint" />
            <mxPoint x="280" y="1740" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-33" value="&lt;font&gt;SelectionKey key = iterator.next()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="200" y="1600" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-41" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-38" target="_Ud4IvRuXKHlU2RU2Mxn-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-38" value="&lt;font style=&quot;font-size: 10px&quot;&gt;SocketChannel socketChannel = server.&lt;b&gt;accept&lt;/b&gt;()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;上一步找到服务端Channel，这里执行accept()建立连接获取客户端Channel&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="180" y="1920" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-43" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-40" target="_Ud4IvRuXKHlU2RU2Mxn-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-40" value="&lt;font&gt;socketChannel&lt;br&gt;.configureBlocking(false)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="200" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-56" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-42" target="_Ud4IvRuXKHlU2RU2Mxn-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-42" value="SelectionKey selKey = socketChannel.register(selector, SelectionKey.OP_READ)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="180" y="2060" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-47" value="&lt;font color=&quot;#007fff&quot;&gt;OP_ACCEPT&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#000000;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-44" target="_Ud4IvRuXKHlU2RU2Mxn-50" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="290" y="1870" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-49" value="&lt;font color=&quot;#007fff&quot;&gt;OP_READ&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-44" target="_Ud4IvRuXKHlU2RU2Mxn-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="1830" />
              <mxPoint x="580" y="1830" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-44" value="&lt;font style=&quot;font-size: 10px&quot;&gt;SelectionKey事件类型&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;arcSize=7;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="220" y="1760" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-52" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-48" target="_Ud4IvRuXKHlU2RU2Mxn-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-48" value="&lt;font&gt;SocketChannel socketChannel = (SocketChannel) key.channel()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="1860" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-69" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-50" target="_Ud4IvRuXKHlU2RU2Mxn-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-50" value="&lt;font&gt;ServerSocketChannel server = (ServerSocketChannel) key.channel()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="180" y="1860" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-54" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-51" target="_Ud4IvRuXKHlU2RU2Mxn-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-51" value="&lt;font&gt;ByteBuffer byteBuffer = ByteBuffer.allocateDirect(128)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="1930" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-57" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-53" target="_Ud4IvRuXKHlU2RU2Mxn-55" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="580" y="2120" />
              <mxPoint x="280" y="2120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-53" value="&lt;font&gt;socketChannel.&lt;b&gt;read&lt;/b&gt;(byteBuffer)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="2000" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-58" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-55" target="_Ud4IvRuXKHlU2RU2Mxn-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-55" value="iterator.remove()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;清除已处理完成的事件&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="180" y="2140" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-63" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-60" target="_Ud4IvRuXKHlU2RU2Mxn-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-66" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-60" target="_Ud4IvRuXKHlU2RU2Mxn-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-60" value="SelectorProvider.provider()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;依次从环境变量、SPI机制加载SelectorProvider, 都没有指定则创建默认的DefaultSelectorProvider&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="250" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-62" value="createProvider(|&lt;br&gt;&quot;sun.nio.ch.EPollSelectorProvider&quot;)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;根据系统类型反射创建对应的SelectorProvider实例, 当前是Linux,所以创建EpollSelectorProvider&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="250" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-68" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-64" target="_Ud4IvRuXKHlU2RU2Mxn-67" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="730" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-64" value="&lt;font color=&quot;#000099&quot;&gt;EpollSelectorProvider&lt;/font&gt;#&lt;br&gt;&lt;b&gt;openServerSocketChannel&lt;/b&gt;()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这个方法是继承自抽象类SelectorProviderImpl&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="340" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-67" target="r2otj2z_qggjg5XV46mg-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-67" value="new &lt;b&gt;ServerSocketChannelImpl&lt;/b&gt;(this)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;这步主要是创建了&lt;b&gt;文件描述符&lt;/b&gt;，和&lt;b&gt;SelectorProvider&lt;/b&gt;实例&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="350" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-74" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-71" target="_Ud4IvRuXKHlU2RU2Mxn-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-80" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-71" target="_Ud4IvRuXKHlU2RU2Mxn-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-71" value="socket = ServerSocketAdaptor.create(this)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;适配器模式&lt;/b&gt;，将ServerSocketChannel接口适配为ServerSocket的接口&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="430" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-78" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-73" target="_Ud4IvRuXKHlU2RU2Mxn-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-73" value="impl = new SocksSocketImpl()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这个实例貌似没什么用&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="440" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-77" value="this.ssc = ssc" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="510" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-84" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-79" target="_Ud4IvRuXKHlU2RU2Mxn-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-79" value="bind(local, 50)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="570" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-86" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-83" target="_Ud4IvRuXKHlU2RU2Mxn-85" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-83" value="&lt;b&gt;ssc&lt;/b&gt;.bind(local, backlog)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;由此可见ServerSocketChannel才是&lt;br&gt;真正的ServerSocket的&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="570" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-88" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-85" target="_Ud4IvRuXKHlU2RU2Mxn-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-91" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-85" target="_Ud4IvRuXKHlU2RU2Mxn-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-85" value="Net.&lt;b&gt;bind&lt;/b&gt;(fd, isa.getAddress(), isa.getPort())&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;将IP和端口绑定到ServerSocketChannel的fd&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="960" y="560" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-93" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-87" target="_Ud4IvRuXKHlU2RU2Mxn-94" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1200" y="670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-87" value="Net.&lt;b&gt;listen&lt;/b&gt;(fd, backlog &amp;lt; 1 ? 50 : backlog)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;调用底层listen()函数，将套接字文件描述符从主动转为被动文件描述符，然后用于被动监听客户端的连接&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="940" y="640" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-89" value="这就和LinuxC socket对应起来了" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1241" y="630" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-90" value="调用系统调用bind()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1220" y="570" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-94" value="调用系统调用listen()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1220" y="650" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-95" value="IOUtil.configureBlocking(fd, block)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;通过native方法设置的&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="710" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-104" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-98" target="_Ud4IvRuXKHlU2RU2Mxn-103" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-98" value="new &lt;b&gt;EPollSelectorImpl&lt;/b&gt;(this)&lt;br&gt;Linux默认用的" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="790" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-100" value="&lt;font color=&quot;#000099&quot;&gt;EPollSelectorProvider.class&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="510" y="770" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-106" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-103" target="_Ud4IvRuXKHlU2RU2Mxn-105" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="RfxcRUAAiVo4TYhAKrvK-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="_Ud4IvRuXKHlU2RU2Mxn-103" target="RfxcRUAAiVo4TYhAKrvK-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-103" value="pipeFds = IOUtil.makePipe(false);&lt;br&gt;&lt;div&gt;fd0 = (int) (pipeFds &amp;gt;&amp;gt;&amp;gt; 32);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; fd1 = (int) pipeFds;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;创建管道，fd0用于读，fd1用于写&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="780" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_Ud4IvRuXKHlU2RU2Mxn-105" value="调用系统调用pipe(),创建管道" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="960" y="790" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-4" value="" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000099;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="RfxcRUAAiVo4TYhAKrvK-0" target="vMLwcvEIQ6NcWGhzbUon-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#000099;strokeColor=#330000;curved=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="RfxcRUAAiVo4TYhAKrvK-0" target="vMLwcvEIQ6NcWGhzbUon-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="RfxcRUAAiVo4TYhAKrvK-0" value="pollWrapper = new EPollArrayWrapper();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="870" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-6" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontColor=#000099;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-3" target="vMLwcvEIQ6NcWGhzbUon-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-3" value="this.epfd = this.&lt;b&gt;epollCreate&lt;/b&gt;()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="960" y="870" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-5" value="调用系统调用epoll_create()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1201" y="870" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-11" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000099;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-7" target="vMLwcvEIQ6NcWGhzbUon-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-7" value="this.pollWrapper.initInterrupt(&lt;br&gt;this.fd0, this.fd1)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="950" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-15" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontColor=#000099;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-10" target="vMLwcvEIQ6NcWGhzbUon-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-10" value="&lt;div&gt;this.outgoingInterruptFD = var2;&lt;/div&gt;&lt;div&gt;this.incomingInterruptFD = var1;&lt;/div&gt;&lt;div&gt;this.&lt;b&gt;epollCtl&lt;/b&gt;(this.epfd, 1, var1, 1);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;向epoll注册监听&lt;b&gt;管道的读端fd&lt;/b&gt;,监听&lt;/font&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;EPOLLIN事件&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="961" y="935" width="199" height="70" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-14" value="调用系统调用epoll_ctl()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1201" y="950" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-19" value="看完源码实现发现&lt;br&gt;就是Epoll的Java版Socket编程实现，&lt;br&gt;代码和/epoll目录的C代码并无实质差别" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="160" y="180" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-23" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-20" target="vMLwcvEIQ6NcWGhzbUon-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-25" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-20" target="vMLwcvEIQ6NcWGhzbUon-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-20" value="&lt;div&gt;k = ((AbstractSelector)sel)&lt;br&gt;.register(this, ops, att);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;往pollWrapper.eventsLow、fdToKey、keys、SelectionKeyImpl.interestOps等记录一下要监听或修改的fd及事件信息&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="460" y="1015" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-22" value="addKey(k);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Channel 中也存一下SelectionKey&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="1260" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-29" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-24" target="vMLwcvEIQ6NcWGhzbUon-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-24" value="&lt;div&gt;SelectionKeyImpl k = new &lt;b&gt;SelectionKeyImpl&lt;/b&gt;((SelChImpl)ch, this);&lt;/div&gt;&lt;div&gt;k.attach(attachment);&lt;/div&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;实例化Channel和Selector的映射SelectionKey&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="1020" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-31" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-28" target="vMLwcvEIQ6NcWGhzbUon-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-44" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-28" target="vMLwcvEIQ6NcWGhzbUon-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-28" value="implRegister(k)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="740" y="1100" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-33" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-30" target="vMLwcvEIQ6NcWGhzbUon-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-30" value="&lt;b&gt;fdToKey&lt;/b&gt;.put(fd, ski)&lt;span&gt;;&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;pollWrapper.add(fd);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;keys&lt;/b&gt;.add(ski);&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="980" y="1085" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-35" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-32" target="vMLwcvEIQ6NcWGhzbUon-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-32" value="setUpdateEvents(var1, (byte)0, true)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;var1这里是服务端Socket FD，&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;(byte)0只是清空下关注的服务端socketFd事件，添加关注的事件是在后面interestOps()中添加的&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1260" y="1085" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-39" value="Y" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-34" target="vMLwcvEIQ6NcWGhzbUon-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-41" value="N" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-34" target="vMLwcvEIQ6NcWGhzbUon-40" edge="1">
          <mxGeometry x="0.1114" y="10" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-34" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;fd &amp;lt; &lt;br&gt;MAX_UPDATE_ARRAY_SIZE&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;arcSize=13;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1720" y="1100" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-38" value="EpollArrayWrapper.&lt;b&gt;eventsLow&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;fd对应索引byte注册监听的事件&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;arcSize=13;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1920" y="1100" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-40" value="EpollArrayWrapper.&lt;b&gt;eventsHigh&lt;/b&gt;&lt;br&gt;put(fd, 0)" style="whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;arcSize=13;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1920" y="1180" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-42" value="fd对应byte == -1 表示什么？" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="2100" y="1110" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-7" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-43" target="8LeemYQ3Dip39AOmkqmU-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-43" value="k.interestOps(ops)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="740" y="1200" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-10" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-45" target="vMLwcvEIQ6NcWGhzbUon-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-45" value="&lt;div&gt;&lt;div&gt;if ((ops &amp;amp; SelectionKey.OP_ACCEPT) != 0)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; newOps |= Net.POLLIN;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;sk.selector.putEventOps(sk, newOps);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1181" y="1190" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-67" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#330000;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-47" target="vMLwcvEIQ6NcWGhzbUon-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-11" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-47" target="vMLwcvEIQ6NcWGhzbUon-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1720" y="1220" />
              <mxPoint x="1720" y="1170" />
              <mxPoint x="1660" y="1170" />
              <mxPoint x="1660" y="1120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-47" value="&lt;div&gt;updateDescriptors[updateCount++] = fd;&lt;br&gt;setUpdateEvents(fd, b, false);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1440" y="1200" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-54" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-50" target="vMLwcvEIQ6NcWGhzbUon-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-50" value="lockAndDoSelect((timeout == 0) ? -1 : timeout)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="320" y="1380" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-52" value="SelectorImpl.java" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="364" y="1360" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-13" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-53" target="8LeemYQ3Dip39AOmkqmU-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-53" value="EpollSelectorImpl#&lt;br&gt;doSelect(timeout)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="560" y="1380" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-58" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-55" target="vMLwcvEIQ6NcWGhzbUon-57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-55" value="begin()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册中断回调&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="781" y="1440" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-60" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-57" target="vMLwcvEIQ6NcWGhzbUon-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-62" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-57" target="vMLwcvEIQ6NcWGhzbUon-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-57" value="pollWrapper.poll(timeout)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="781" y="1500" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-71" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-59" target="vMLwcvEIQ6NcWGhzbUon-70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-59" value="end()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;清除中断回调&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="781" y="1620" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-64" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-61" target="vMLwcvEIQ6NcWGhzbUon-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-66" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-61" target="vMLwcvEIQ6NcWGhzbUon-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-61" value="this.updateRegistrations()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1040" y="1500" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-75" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-63" target="vMLwcvEIQ6NcWGhzbUon-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-63" value="this.updated = this.&lt;b&gt;epollWait&lt;/b&gt;(this.pollArrayAddress, NUM_EPOLLEVENTS, var1, this.epfd)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;阻塞等待&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1025" y="1560" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-65" value="for(int var2 = 0; var2 &amp;lt; this.updateCount; ++var2)&lt;br&gt;this.&lt;b&gt;epollCtl&lt;/b&gt;(this.epfd, var9, var3, var4)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1260" y="1490" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-68" value="epoll的select方法会堵塞线程，为了唤醒堵塞的线程，&lt;br&gt;需要在其监听的FD上触发监听的事件；&lt;br&gt;EPollSelectorImpl中的管道就是用于中断唤醒select阻塞的线程，&lt;br&gt;只需要往管道写端写数据，读端就会产生EPOLLIN事件，从而中断select()。&lt;br&gt;不过中断select()做什么用的？退出？" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="140" y="840" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-73" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#330000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-70" target="vMLwcvEIQ6NcWGhzbUon-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-70" value="&lt;div&gt;processDeregisterQueue()&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;注销cancelledKeys中的SelectionKey&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="781" y="1680" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-30" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-72" target="8LeemYQ3Dip39AOmkqmU-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-49" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-72" target="8LeemYQ3Dip39AOmkqmU-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-72" value="this.updateSelectedKeys()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;遍历读取pollArray获取触发事件的FD和事件信息，并记录到&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;selectedKeys&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="781" y="1900" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-21" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vMLwcvEIQ6NcWGhzbUon-74" target="8LeemYQ3Dip39AOmkqmU-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-74" value="for (int i=0; i&amp;lt;updated; i++)&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1050" y="1640" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="vMLwcvEIQ6NcWGhzbUon-76" value="for() end" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1050" y="1860" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-4" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-3" target="vMLwcvEIQ6NcWGhzbUon-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-5" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;dashed=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-3" target="vMLwcvEIQ6NcWGhzbUon-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-3" value="实现了channel和selector的&lt;br&gt;双向查找" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="360" y="1160" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-9" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-6" target="vMLwcvEIQ6NcWGhzbUon-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-6" value="&lt;div&gt;channel.translateAndSetInterestOps(&lt;br&gt;ops, this)&lt;br&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;将SelectionKey中定义的事件转换成Net中定义的事件&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="961" y="1190" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-14" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=11;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-12" target="vMLwcvEIQ6NcWGhzbUon-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-16" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-12" target="8LeemYQ3Dip39AOmkqmU-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-12" value="processDeregisterQueue()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;注销cancelledKeys中的SelectionKey&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="780" y="1380" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-15" value="implDereg(ski);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1040" y="1380" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-24" value="Y" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-17" target="8LeemYQ3Dip39AOmkqmU-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-25" value="N" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-17" target="vMLwcvEIQ6NcWGhzbUon-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-17" value="&lt;font style=&quot;font-size: 8px&quot;&gt;getDescriptor(i) == &lt;br&gt;incomingInterruptFD&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;获取触发事件的FD, 是否是管道读端&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1055" y="1720" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-22" value="offset = SIZE_EPOLLEVENT * i + FD_OFFSET;&lt;br&gt;pollArray.getInt(offset)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1160" y="1685" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-26" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-23" target="vMLwcvEIQ6NcWGhzbUon-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-23" value="&lt;div&gt;interruptedIndex = i;&lt;/div&gt;&lt;div&gt;interrupted = true;&lt;br&gt;&lt;font style=&quot;font-size: 9px&quot; color=&quot;#007fff&quot;&gt;如果是管道读端是用来中断Select的&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1241" y="1780" width="159" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-28" value="&lt;b&gt;其他：&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;为何输入流用于读，输出流用于写？这么定义主要是以内存为参照对象，数据从流读到内存，从内存看来就是输入，数据从内存写入流，从内存看就是输出。&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;dashed=1;fontSize=9;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="680" y="19" width="480" height="141" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-34" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-29" target="8LeemYQ3Dip39AOmkqmU-33" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1090" y="1940" />
              <mxPoint x="1190" y="1940" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-29" value="&lt;font style=&quot;font-size: 10px&quot;&gt;for (int i=0; i&amp;lt;pollWrapper.updated; i++)&amp;nbsp;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1000" y="1910" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-31" value="&lt;font style=&quot;font-size: 10px&quot;&gt;for end&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1001" y="2220" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-38" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-33" target="8LeemYQ3Dip39AOmkqmU-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-33" value="&lt;font style=&quot;font-size: 10px&quot;&gt;&amp;nbsp;int nextFD = pollWrapper.&lt;b&gt;getDescriptor&lt;/b&gt;(i)&lt;br&gt;rOps = pollWrapper.&lt;b&gt;getEventOps&lt;/b&gt;(i)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;这获取的就是实际触发事件的fd和事件value&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1090" y="1960" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-41" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-37" target="8LeemYQ3Dip39AOmkqmU-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-37" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;SelectionKeyImpl ski = &lt;b&gt;fdToKey&lt;/b&gt;.get(Integer.valueOf(nextFD))&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1090" y="2020" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-45" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-40" target="8LeemYQ3Dip39AOmkqmU-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-40" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;ski.channel.&lt;b&gt;translateAndSetReadyOps&lt;/b&gt;(&lt;br&gt;rOps, ski);&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1090" y="2080" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-44" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-43" target="8LeemYQ3Dip39AOmkqmU-31" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1190" y="2200" />
              <mxPoint x="1091" y="2200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-43" value="&lt;font style=&quot;font-size: 10px&quot;&gt;&lt;div&gt;检查下触发的事件是否是在监听的事件interestOps，是则记录下&lt;br&gt;&lt;b&gt;selectedKeys&lt;/b&gt;.add(ski);&lt;/div&gt;&lt;div&gt;numKeysUpdated++;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1090" y="2140" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-51" value="Y" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-48" target="8LeemYQ3Dip39AOmkqmU-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="980" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-54" value="N" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="8LeemYQ3Dip39AOmkqmU-48" target="8LeemYQ3Dip39AOmkqmU-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-48" value="pollWrapper&lt;br&gt;.interrupted()" style="rhombus;whiteSpace=wrap;html=1;rounded=1;glass=0;strokeWidth=1;shadow=0;fontSize=10;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="811" y="2260" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-52" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;中断处理&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;暂略&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="990" y="2260" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8LeemYQ3Dip39AOmkqmU-53" value="return numKeysUpdated" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="811" y="2338" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="r2otj2z_qggjg5XV46mg-0" target="r2otj2z_qggjg5XV46mg-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-0" value="&lt;div&gt;this.fd =&amp;nbsp; &lt;b&gt;Net&lt;/b&gt;.&lt;b&gt;serverSocket&lt;/b&gt;(true);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.fdVal = IOUtil.fdVal(fd);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.state = ST_INUSE;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="980" y="350" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-5" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="r2otj2z_qggjg5XV46mg-2" target="r2otj2z_qggjg5XV46mg-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-2" value="&lt;div&gt;this.fd =&amp;nbsp; &lt;b&gt;Net&lt;/b&gt;.&lt;b&gt;serverSocket&lt;/b&gt;(true);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.fdVal = IOUtil.fdVal(fd);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.state = ST_INUSE;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1240.5" y="350" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="r2otj2z_qggjg5XV46mg-4" value="调用系统调用socket()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1500" y="350" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mmM9-YH2jpbEQEIwD-xE-0" value="这里之所以改为非阻塞模式，是因为测试代码中用的单线程轮询的方式处理selectedKeys中触发事件的，如果配置成阻塞模式，后面accept() read() 会阻塞这个唯一的线程，就无法继续读取就绪事件了；&lt;br&gt;如果事件处理在单独线程中执行可以设置成阻塞模式" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#007FFF;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="650" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-0" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;sun.nio.ch.ServerSocketChannelImpl&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;fd&lt;/b&gt;&amp;nbsp;= {FileDescriptor@556}&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//ServerSocket文件描述符（文件描述符对应操作系统对底层硬件封装的操作接口）&lt;/font&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;是操作底层文件（Linux内核所有设备都是文件）的应用空间接口（一般跟代码跟到系统调用对应的native方法就够了，更多详情参考Linux手册）&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;通过Net.serverSocket()创建&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;fdVal&lt;/b&gt;&amp;nbsp;= 21&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//fd的fd字段的值，对应系统调用open打开的文件句柄&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;thread = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//long类型，ID of native thread currently blocked in this channel, for signalling&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;lock = {Object@550}&amp;nbsp;&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//防止多线程并发绑定到同一个端口&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;stateLock = {Object@551}&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//同步更新ServerSocketChannel状态的锁&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;state&lt;/b&gt;&amp;nbsp;= 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//ServerSocketchannel状态（-1：未初始化，0：启用中，1：强制关闭）&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;localAddress = null&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;isReuseAddress = false&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;socket&lt;/b&gt;&amp;nbsp;= null&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//ServerSocketAdaptor实例,由适配器模式的特点知道其实就是ServerSocketChannelImpl,只不过是包装了一层&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;provider&lt;/b&gt;&amp;nbsp;= {EPollSelectorProvider@510}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;keys&lt;/b&gt;&amp;nbsp;= null&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//channel上绑定的SelectionKey数组（为啥是个数组难道还能有多个？，一个Channel(fd)可以注册到多个selector(epoll)上？应该可以）&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;keyCount&lt;/b&gt;&amp;nbsp;= 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//SelectionKey数组的数量&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;keyLock = {Object@547}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;regLock = {Object@548}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;nonBlocking&lt;/b&gt;&amp;nbsp;= false&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;//ServerSocket是否为阻塞模式，默认为阻塞模式，？？？&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;closeLock = {Object@549}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;open&lt;/b&gt;&amp;nbsp;= true&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//Channel开关状态，初始化时默认为true, 调用close()后改为false&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interruptor = null&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interrupted = null&lt;/span&gt;&lt;/div&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1120" y="160" width="520" height="400" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-8" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=-0.006;exitY=0.181;exitDx=0;exitDy=0;exitPerimeter=0;endArrow=open;endFill=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="bj8HcREEnK7iysANMu2g-1" target="bj8HcREEnK7iysANMu2g-0">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-1" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;sun.nio.ch.ServerSocketAdaptor　给ssc适配接口方法&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;font-size: 10px; background-color: initial; border-color: var(--border-color);&quot;&gt;ServerSocketChannelImpl ssc&lt;/b&gt;;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;// Timeout &quot;option&quot; value for accepts&lt;/span&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;volatile int timeout = 0;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;继承自ServerSocket的属性：&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;boolean created = false;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;boolean bound = false;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;boolean closed = false;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;Object closeLock = new Object();&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;SocketImpl impl;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//这里会创建&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;SocksSocketImpl实例，但是用不到&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;boolean oldImpl = false;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-560" y="160" width="520" height="210" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-9" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;endArrow=open;endFill=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="bj8HcREEnK7iysANMu2g-2" target="bj8HcREEnK7iysANMu2g-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-10" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.001;exitY=0.293;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;endArrow=open;endFill=0;exitPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="bj8HcREEnK7iysANMu2g-2" target="bj8HcREEnK7iysANMu2g-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-2" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;sun.nio.ch.EPollSelectorImpl (最核心的类，像“胶水”类)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;fd0 = 23&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//管道的读端fd&lt;/font&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;fd1 = 24&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//管道的写端fd&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;pollWrapper&lt;/b&gt;&amp;nbsp;= {EPollArrayWrapper@584}&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//Linux底层epoll接口封装类&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;fdToKey&lt;/b&gt;&amp;nbsp;= {HashMap@585}&amp;nbsp; size = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//被epoll监听的FD -&amp;gt; SelectionKey 映射&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;closed = false&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interruptLock = {Object@579}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interruptTriggered = false&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;selectedKeys&lt;/b&gt;&amp;nbsp;= {HashSet@571}&amp;nbsp; size = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//触发了事件的SelectionKey集合&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;keys&lt;/b&gt;&amp;nbsp;= {HashSet@570}&amp;nbsp; size = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//被epoll监听的SelectionKey集合&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;publicKeys&lt;/b&gt;&amp;nbsp;= {Collections$UnmodifiableSet@576}&amp;nbsp; size = 0&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//不可修改的keys public副本，没看到哪里用？&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;publicSelectedKeys&lt;/b&gt;&amp;nbsp;= {Util$3@578}&amp;nbsp; size = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//没看到哪里用这个？&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;selectorOpen = {AtomicBoolean@567} &quot;true&quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;provider&lt;/b&gt;&amp;nbsp;= {EPollSelectorProvider@556}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;cancelledKeys&lt;/b&gt;&amp;nbsp;= {HashSet@569}&amp;nbsp; size = 0&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//取消监听的SeletionKey集合&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interruptor = null&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-560" y="600" width="520" height="280" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-3" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;sun.nio.ch.EPollArrayWrapper (主要是对linux epoll接口的封装)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;epfd&lt;/b&gt;&amp;nbsp;= 28&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//epollCreate()创建的epoll fd&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;pollArray&lt;/b&gt;&amp;nbsp;= {AllocatedNativeObject@610}&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;//用于存储实际触发的事件，和C语言指针操作&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;struct epoll_event events[EPOLLEVENTS]&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;border-color: var(--border-color); color: rgb(0, 127, 255); font-size: 10px;&quot;&gt;类似，Unsafe实现的，AllocatedNativeObject就是&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;Java版的&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;struct epoll_event&lt;/span&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/font&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;pollArrayAddress&lt;/b&gt;&amp;nbsp;= 140381478768640&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;　&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//pollArray的地址&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;outgoingInterruptFD&lt;/b&gt;&amp;nbsp;= 27&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//EPollSelectorImpl管道的写端fd&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;incomingInterruptFD&lt;/b&gt;&amp;nbsp;= 26&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp;//EPollSelectorImpl管道的读端fd&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interruptedIndex = 0&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;updated = 0&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;updateLock = {Object@599}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;updateCount&lt;/b&gt;&amp;nbsp;= 0&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp;//需要用epoll_ctl增删改的FD的数量&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;updateDescriptors&lt;/b&gt;&amp;nbsp;= {int[64]@600}&amp;nbsp; &amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//需要用epoll_ctl增删改的FD的数组集合，&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;eventsLow&lt;/b&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&amp;nbsp;= {byte[65536]@601}&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;//需要用epoll_ctl增删改的的事件集合，fd作为索引对应的byte数据就是要监听的事件集合&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;eventsHigh&lt;/b&gt;&amp;nbsp;= {HashMap@614}&amp;nbsp; size = 0&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;registered&lt;/b&gt;&amp;nbsp;= {BitSet@602} &quot;{}&quot;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//已经注册过监听的FD值&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interrupted = false&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1120" y="600" width="520" height="320" as="geometry" />
        </mxCell>
        <mxCell id="bj8HcREEnK7iysANMu2g-4" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;sun.nio.ch.SelectionKeyImpl&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;用于查询Channel(如Socket Fd)注册到了哪个Selector(如epoll)上&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;final&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;SelChImpl&lt;/b&gt;&amp;nbsp;channel;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//监听的channel, 本质就是要用epoll监听的FD&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;public final&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;SelectorImpl&lt;/b&gt;&amp;nbsp;selector;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//epoll封装类&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;private int index;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;private volatile int&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;interestOps&lt;/b&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;//epoll监听上面SelChImpl channel实例的事件（多个事件按位或后存储在一个int中）&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;private int&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;readyOps&lt;/b&gt;;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;//某次触发的事件value&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;继承的字段：&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;private volatile boolean valid = true;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); font-size: 10px;&quot;&gt;private volatile Object attachment;&lt;/span&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1120" y="960" width="520" height="200" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="23TZKhDc89f57bKxahfn" name="Java NIO工作流程简图">
    <mxGraphModel dx="1434" dy="879" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="TuL8_JntQYpgIAM_35Ss-0" />
        <mxCell id="TuL8_JntQYpgIAM_35Ss-1" parent="TuL8_JntQYpgIAM_35Ss-0" />
        <mxCell id="8YeMiScQJa7SkRbDJ4uO-3" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="340" y="150" width="1080" height="360" as="geometry" />
        </mxCell>
        <mxCell id="GaqBmh58d_4I2eWU2Wzl-1" value="" style="rounded=1;whiteSpace=wrap;html=1;arcSize=3;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="700" y="290" width="200" height="160" as="geometry" />
        </mxCell>
        <mxCell id="KEEIDoXM97dpTrJWykyn-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="Too2izrHl2M2gL6e_p3n-1" target="KEEIDoXM97dpTrJWykyn-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KEEIDoXM97dpTrJWykyn-2" value="&lt;font color=&quot;#007fff&quot;&gt;系统调用&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=10;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="KEEIDoXM97dpTrJWykyn-0" target="Too2izrHl2M2gL6e_p3n-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-4" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="360" y="275" width="100" height="190" as="geometry" />
        </mxCell>
        <mxCell id="8YeMiScQJa7SkRbDJ4uO-1" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="40" y="150" width="220" height="360" as="geometry" />
        </mxCell>
        <mxCell id="8YeMiScQJa7SkRbDJ4uO-2" value="客户端集群" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="120" y="120" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YeMiScQJa7SkRbDJ4uO-4" value="服务端" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="600" y="120" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="f1ZayxCtdhyKZO4_JSvL-0" value="&lt;h1&gt;Java NIO 工作流程简图（JDK8）&lt;/h1&gt;&lt;div&gt;以Socket Channel、Epoll Selector为例.&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="40" y="19" width="640" height="101" as="geometry" />
        </mxCell>
        <mxCell id="SCQ2OuhlQA9NOCdSsyXn-1" value="&lt;font style=&quot;font-size: 8px&quot;&gt;读取触发&lt;br&gt;事件信息&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="GaqBmh58d_4I2eWU2Wzl-1" target="SCQ2OuhlQA9NOCdSsyXn-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GaqBmh58d_4I2eWU2Wzl-2" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;Epoll Selector&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="765" y="290" width="90" height="10" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-3" target="GaqBmh58d_4I2eWU2Wzl-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="620" y="310" />
              <mxPoint x="620" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-3" value="&lt;font style=&quot;font-size: 10px&quot;&gt;SocketChannel&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="520" y="290" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-4" value="&lt;font style=&quot;font-size: 10px&quot;&gt;SocketChannel&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="520" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-5" target="GaqBmh58d_4I2eWU2Wzl-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="520" y="370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="620" y="430" />
              <mxPoint x="620" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-5" target="sCkPyD-Jr61byvmwNfTB-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-5" value="&lt;span style=&quot;font-size: 10px&quot;&gt;SocketChannel&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="520" y="410" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-9" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-6" target="sCkPyD-Jr61byvmwNfTB-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-6" value="&lt;font style=&quot;font-size: 10px&quot;&gt;Ser2Cli Socket&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="370" y="290" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-7" target="sCkPyD-Jr61byvmwNfTB-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1.01;entryY=0.682;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-7" target="BaJYHBZN2kcvhg0SBqgw-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-7" value="&lt;span style=&quot;font-size: 10px&quot;&gt;Ser2Cli Socket&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="370" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-8" target="sCkPyD-Jr61byvmwNfTB-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.92;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-8" target="BaJYHBZN2kcvhg0SBqgw-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-8" value="&lt;span style=&quot;font-size: 10px&quot;&gt;Ser2Cli Socket&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="370" y="410" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.012;entryY=0.443;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-16" target="BaJYHBZN2kcvhg0SBqgw-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-16" value="&lt;font style=&quot;font-size: 10px&quot;&gt;Client Socket&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="170" y="290" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.68;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-17" target="BaJYHBZN2kcvhg0SBqgw-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-17" value="&lt;font style=&quot;font-size: 10px&quot;&gt;Client Socket&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="170" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.92;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-18" target="BaJYHBZN2kcvhg0SBqgw-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-18" value="&lt;font style=&quot;font-size: 10px&quot;&gt;Client Socket&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="170" y="410" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-21" target="sCkPyD-Jr61byvmwNfTB-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-21" value="&lt;font style=&quot;font-size: 10px&quot;&gt;Client1&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="60" y="290" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-22" target="sCkPyD-Jr61byvmwNfTB-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-22" value="&lt;span style=&quot;font-size: 10px&quot;&gt;Client2&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="60" y="350" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-23" target="sCkPyD-Jr61byvmwNfTB-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-23" value="&lt;span style=&quot;font-size: 10px&quot;&gt;Client3&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="60" y="410" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-30" target="sCkPyD-Jr61byvmwNfTB-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-30" value="&lt;br&gt;ServerSocket" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="360" y="200" width="100" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-31" value="port" style="rounded=1;whiteSpace=wrap;html=1;arcSize=8;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="360" y="200" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-35" value="&lt;font style=&quot;font-size: 8px&quot;&gt;１ 注册SelectionKey&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-32" target="GaqBmh58d_4I2eWU2Wzl-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-32" value="&lt;font style=&quot;font-size: 10px&quot;&gt;ServerSocketChannel&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="500" y="207.5" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KEEIDoXM97dpTrJWykyn-0" value="Linux epoll" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="700" y="530" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-1" value="&lt;font style=&quot;font-size: 8px&quot;&gt;OP_ACCEPT&lt;br&gt;４ 处理连接事件&lt;br&gt;&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="TuL8_JntQYpgIAM_35Ss-1" target="BaJYHBZN2kcvhg0SBqgw-0" edge="1">
          <mxGeometry x="0.3333" relative="1" as="geometry">
            <mxPoint x="1000" y="370" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1030" y="370" />
              <mxPoint x="1030" y="310" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-2" value="OP_WRITE" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="SCQ2OuhlQA9NOCdSsyXn-0" target="BaJYHBZN2kcvhg0SBqgw-4" edge="1">
          <mxGeometry x="0.5556" y="-10" relative="1" as="geometry">
            <mxPoint x="960" y="370" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1030" y="370" />
              <mxPoint x="1030" y="430" />
            </Array>
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SCQ2OuhlQA9NOCdSsyXn-0" value="events handler" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#fff2cc;strokeColor=#d6b656;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="940" y="350" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-3" value="５ 建立客户端连接SocketFD" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=8;fontColor=#007FFF;strokeColor=#007FFF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-0" target="CkvRUC_iMmN2UxCiYWrB-4" edge="1">
          <mxGeometry x="0.3567" relative="1" as="geometry">
            <mxPoint x="410" y="270" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1180" y="310" />
              <mxPoint x="1180" y="260" />
              <mxPoint x="410" y="260" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-0" value="AcceptHandler" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#fff2cc;strokeColor=#d6b656;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1080" y="290" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-3" target="CkvRUC_iMmN2UxCiYWrB-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-3" value="ReadHandler&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;从Ser2CliSocket读&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#fff2cc;strokeColor=#d6b656;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1080" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-4" value="WriteHandler&lt;br&gt;&lt;font style=&quot;font-size: 8px&quot; color=&quot;#007fff&quot;&gt;写的前置处理&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#fff2cc;strokeColor=#d6b656;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1080" y="410" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-10" value="&lt;font style=&quot;font-size: 8px&quot;&gt;CONN&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.989;exitY=0.112;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;exitPerimeter=0;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-6" target="sCkPyD-Jr61byvmwNfTB-30" edge="1">
          <mxGeometry x="0.0111" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="330" y="228" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-11" value="&lt;font style=&quot;font-size: 8px&quot;&gt;RW&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1.014;exitY=0.436;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;exitPerimeter=0;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-6" target="sCkPyD-Jr61byvmwNfTB-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-12" value="&lt;font style=&quot;font-size: 8px&quot;&gt;RW&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.976;exitY=0.678;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;exitPerimeter=0;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-6" target="sCkPyD-Jr61byvmwNfTB-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-13" value="&lt;font style=&quot;font-size: 8px&quot;&gt;RW&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1.014;exitY=0.918;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;exitPerimeter=0;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-6" target="sCkPyD-Jr61byvmwNfTB-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-14" value="epoll监听网卡事件&lt;br&gt;2 EPOLLIN事件(ACCEPT)&lt;br&gt;７EPOLLIN事件(READ)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="BaJYHBZN2kcvhg0SBqgw-6" target="KEEIDoXM97dpTrJWykyn-0" edge="1">
          <mxGeometry x="0.0833" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BaJYHBZN2kcvhg0SBqgw-6" value="TCP/IP" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="280" y="200" width="40" height="250" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-1" value="OP_READ&lt;br&gt;9 读取数据" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" target="BaJYHBZN2kcvhg0SBqgw-3" edge="1">
          <mxGeometry x="0.3333" y="-10" relative="1" as="geometry">
            <mxPoint x="1000" y="370" as="sourcePoint" />
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=8;fontColor=#007FFF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="CkvRUC_iMmN2UxCiYWrB-5" target="CkvRUC_iMmN2UxCiYWrB-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-5" value="Buffer" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#e3c800;fontColor=#000000;strokeColor=#B09500;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1200.5" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="CkvRUC_iMmN2UxCiYWrB-9" target="jLCUi7b_pL3dA_9bS_0q-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-9" value="BizService" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1320" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sCkPyD-Jr61byvmwNfTB-12" value="&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;6 注册&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;客户端Channel&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;SelectionKey&lt;/span&gt;&lt;br&gt;&lt;font style=&quot;font-size: 7px&quot;&gt;和第一步差不多&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;strokeColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" source="sCkPyD-Jr61byvmwNfTB-4" target="GaqBmh58d_4I2eWU2Wzl-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-15" value="等待事件返回时用的共享内存（直接内存）" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="700" y="450" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-17" value="3 返回就绪事件列表&lt;br&gt;8 返回就绪事件列表" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="820" y="480" width="93" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CkvRUC_iMmN2UxCiYWrB-18" value="&lt;font color=&quot;#0000ff&quot;&gt;SelectionKey是Channel和Selector的绑定映射，还有关注的事件信息&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#007FFF;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="720" y="190" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=7;fontColor=#0000FF;strokeColor=#000000;" parent="TuL8_JntQYpgIAM_35Ss-1" source="jLCUi7b_pL3dA_9bS_0q-0" target="sCkPyD-Jr61byvmwNfTB-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-0" value="Buffer" style="whiteSpace=wrap;html=1;rounded=1;arcSize=3;fillColor=#e3c800;fontColor=#000000;strokeColor=#B09500;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="1201" y="450" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jLCUi7b_pL3dA_9bS_0q-8" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;客户端这边流程简化了，其实完全也可以使用Selector&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=7;fontColor=#0000FF;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="70" y="170" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Too2izrHl2M2gL6e_p3n-1" value="EPollArrayWrapper" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#e6d0de;strokeColor=#996185;gradientColor=#d5739d;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="720" y="410" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jYfDTTLgj2ddkshyB-0v-0" value="fdToKey&lt;font style=&quot;font-size: 8px&quot;&gt;(HashMap)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#e6d0de;strokeColor=#996185;gradientColor=#d5739d;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="720" y="310" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jYfDTTLgj2ddkshyB-0v-1" value="keys&lt;font style=&quot;font-size: 8px&quot;&gt;(HashSet)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#e6d0de;strokeColor=#996185;gradientColor=#d5739d;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="720" y="340" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jYfDTTLgj2ddkshyB-0v-2" value="selectedKeys&lt;font style=&quot;font-size: 8px&quot;&gt;(HashSet)&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=6;fillColor=#e6d0de;strokeColor=#996185;gradientColor=#d5739d;" parent="TuL8_JntQYpgIAM_35Ss-1" vertex="1">
          <mxGeometry x="720" y="380" width="160" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="Y3Vc8QFMip017aOnlZnJ" name="NIO Buffer">
    <mxGraphModel dx="2261" dy="879" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="5ruEhwhexM6jTpCP8odR-0" />
        <mxCell id="5ruEhwhexM6jTpCP8odR-1" parent="5ruEhwhexM6jTpCP8odR-0" />
        <mxCell id="SlyO11BrHZgnlwH1OwK_-0" value="&lt;h1 style=&quot;color: rgb(0 , 0 , 0) ; font-family: &amp;#34;helvetica&amp;#34; ; font-style: normal ; letter-spacing: normal ; text-align: left ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(248 , 249 , 250)&quot;&gt;Java NIO Buffer原理（JDK8）&lt;/h1&gt;&lt;div style=&quot;font-family: &amp;#34;helvetica&amp;#34; ; font-style: normal ; letter-spacing: normal ; text-align: left ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(248 , 249 , 250)&quot;&gt;&lt;span style=&quot;color: rgb(0 , 0 , 0) ; font-size: 12px ; font-weight: 400&quot;&gt;以Netty常用&lt;/span&gt;&lt;b style=&quot;color: rgb(0 , 0 , 0) ; font-size: 12px&quot;&gt;PooledUnsafeDirectByteBuf&lt;/b&gt;&lt;span style=&quot;color: rgb(0 , 0 , 0) ; font-size: 12px ; font-weight: 400&quot;&gt;内部封装的NIO &lt;/span&gt;&lt;b style=&quot;color: rgb(0 , 0 , 0) ; font-size: 12px&quot;&gt;DirectByteBuffer&lt;/b&gt;为例。&lt;br&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;Demo:&amp;nbsp;top.kwseeker.netty.part05.codec.ByteBufferTest.java&lt;/font&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="40" y="19" width="480" height="101" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-0" target="EB95lkLiqAowTXk86DeI-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-3" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-0" target="mQhvSbKUOAa_Gd-00jPE-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-0" value="&lt;font style=&quot;font-size: 10px&quot;&gt;ByteBuffer.allocateDirect(1024)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;1 分配直接内存创建DirectByteBuffer缓冲实例&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="40" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;curved=1;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-2" target="EB95lkLiqAowTXk86DeI-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-2" value="start" style="ellipse;whiteSpace=wrap;html=1;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="80" y="160" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-3" target="EB95lkLiqAowTXk86DeI-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-3" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;new DirectByteBuffer(capacity)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-5" target="EB95lkLiqAowTXk86DeI-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-31" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-5" target="EB95lkLiqAowTXk86DeI-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-5" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;super(-1, 0, cap, cap);&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="440" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-7" value="DirectByteBuffer." style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="475" y="220" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-8" target="EB95lkLiqAowTXk86DeI-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-29" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-8" target="EB95lkLiqAowTXk86DeI-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-8" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&amp;nbsp;super(mark, pos, lim, cap)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="640" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-12" value="MappedByteBuffer" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="670" y="220" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-13" target="EB95lkLiqAowTXk86DeI-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-13" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;this(mark, pos, lim, cap, null, 0)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="840" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-15" value="ByteBuffer" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="890" y="220" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-16" target="EB95lkLiqAowTXk86DeI-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-27" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-16" target="EB95lkLiqAowTXk86DeI-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-16" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;super(mark, pos, lim, cap)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="1040" y="240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-18" value="Buffer" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="1301" y="220" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-19" value="&lt;font&gt;&lt;div style=&quot;font-size: 10px&quot;&gt;this.capacity = cap;&lt;/div&gt;&lt;div style=&quot;font-size: 10px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; limit(lim);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; position(pos);&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;按 mark &amp;lt;= position &amp;lt;= limit &amp;lt;= capacity, 初始化这四个值为-1、０、1024、1024&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="1241" y="225" width="199" height="70" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-25" value="&lt;ul&gt;&lt;li&gt;&lt;b&gt;Buffer的属性&lt;br&gt;&lt;/b&gt;capacity容量（可写入元素的个数，不是字节数，不可修改），position位置，limit限制，mark标记&lt;br&gt;mark &amp;lt;= position &amp;lt;= limit &amp;lt;= capacity&lt;br&gt;写模式：position指开始写入位置，limit指能写入的最大数据量&lt;br&gt;flip从写模式切换到读模式&lt;br&gt;读模式：position指开始读取位置，limit指能读取的最大数据量&lt;/li&gt;&lt;li&gt;&lt;b&gt;-XX:+PageAlignDirectMemory 开启按页对齐&lt;/b&gt;(效率高)　&lt;font color=&quot;#cc0066&quot;&gt;TODO&lt;/font&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="520" y="19" width="560" height="141" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-26" value="&lt;font style=&quot;font-size: 10px&quot;&gt;&lt;div&gt;this.hb = hb;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.offset = offset;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="1040" y="300" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-28" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;this.fd = null;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="640" y="300" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-33" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#CC0066;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-30" target="EB95lkLiqAowTXk86DeI-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-30" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;Bits.reserveMemory(size, cap)&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#cc0066&quot;&gt;？？？&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="440" y="320" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-37" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-32" target="EB95lkLiqAowTXk86DeI-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-32" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;base = unsafe.allocateMemory(size)&lt;br&gt;unsafe.setMemory(base, size, (byte) 0)&lt;/span&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px&quot; color=&quot;#007fff&quot;&gt;使用native方法分配直接内存并清空（即全置为０）&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="420" y="380" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-40" value="N" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#000000;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-36" target="EB95lkLiqAowTXk86DeI-38" edge="1">
          <mxGeometry x="-0.2941" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-41" value="Y" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=8;fontColor=#000000;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-36" target="EB95lkLiqAowTXk86DeI-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-36" value="&lt;font color=&quot;#000000&quot;&gt;按页对齐？&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;fontSize=8;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="480" y="440" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-43" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-38" target="EB95lkLiqAowTXk86DeI-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-38" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;address = base;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="370" y="500" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-44" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="5ruEhwhexM6jTpCP8odR-1" source="EB95lkLiqAowTXk86DeI-39" target="EB95lkLiqAowTXk86DeI-42" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="520" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-39" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;address = base + ps - (base &amp;amp; (ps - 1));&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;address是大于base的ps的最小的倍数&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="540" y="500" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB95lkLiqAowTXk86DeI-42" value="&lt;font style=&quot;font-size: 10px&quot;&gt;&lt;div&gt;cleaner = Cleaner.create(this, new Deallocator(base, size, cap));&lt;/div&gt;&lt;div&gt;att = null;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="440" y="580" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-0" value="java.nio.DirectByteBuffer" style="swimlane;startSize=20;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="-520" y="260" width="480" height="220" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-1" value="&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;att = null&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;cleaner = {Cleaner@1077}&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;fd = null&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;hb = null&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;offset&lt;/b&gt; = 0&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;isReadOnly = false&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;bigEndian = true&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;nativeByteOrder = false&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;mark&lt;/b&gt; = -1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;//用于标记某时的position,用reset()恢复position&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;position&lt;/b&gt; = 0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;//写／读到的位置&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;limit&lt;/b&gt; = 1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;//写模式：可写的最大长度，读模式：可读的最大长度&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;capacity&lt;/b&gt; = 1024&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;address&lt;/b&gt; = 139769851512000&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;//直接缓冲内存空间其实偏移&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="mQhvSbKUOAa_Gd-00jPE-0" vertex="1">
          <mxGeometry y="20" width="480" height="200" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-5" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-2" target="mQhvSbKUOAa_Gd-00jPE-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-12" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-2" target="mQhvSbKUOAa_Gd-00jPE-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-2" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;directByteBuffer.put(bytes)&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;测试中bytes长26字节&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="40" y="640" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-7" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-4" target="mQhvSbKUOAa_Gd-00jPE-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-4" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;校验内存空间是否够存储bytes数组&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="640" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-9" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-6" target="mQhvSbKUOAa_Gd-00jPE-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-6" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;通过Bits.copyFromArray(...)将bytes拷贝到直接内存&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="700" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-8" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;pos = pos + length&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="760" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-10" value="测试案例中DIrectByteBuffer空间分配、写、读、清空流程&lt;br style=&quot;font-size: 12px&quot;&gt;&lt;br style=&quot;font-size: 12px&quot;&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;mark&amp;nbsp;&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;position&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;limit&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;capacity&lt;br style=&quot;font-size: 12px&quot;&gt;allocate&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;-1&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;0&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;1024&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;1024&lt;br style=&quot;font-size: 12px&quot;&gt;put&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;-1&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;26&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;1024&lt;span style=&quot;font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;1024&lt;br style=&quot;font-size: 12px&quot;&gt;flip&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;-1&amp;nbsp;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;0&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;写模式切换为读模式&lt;br style=&quot;font-size: 12px&quot;&gt;get&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;br style=&quot;font-size: 12px&quot;&gt;get&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;2&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br style=&quot;font-size: 12px&quot;&gt;...&lt;br style=&quot;font-size: 12px&quot;&gt;get&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;rewind&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;返回到flip之后未读之前&lt;br&gt;get&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;...&lt;br&gt;get&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;10&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;26&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;compact&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;16&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;将未读的数据插入缓冲开始位置，读模式切换为写模式&lt;br&gt;put&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;34&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;flip&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;34&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;mark&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;34&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;记录postion到mark&lt;br&gt;get&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;34&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;br&gt;reset&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;0&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;34&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;读取mark回滚position&lt;br style=&quot;font-size: 12px&quot;&gt;clear&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;-1&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;0&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre ; font-size: 12px&quot;&gt;&#x9;&lt;/span&gt;1024&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;清空索引位，返回allocate后的状态" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="500" y="720" width="540" height="320" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-14" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-11" target="mQhvSbKUOAa_Gd-00jPE-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-22" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-11" target="mQhvSbKUOAa_Gd-00jPE-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-11" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;directByteBuffer.flip()&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="40" y="820" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-18" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-13" target="mQhvSbKUOAa_Gd-00jPE-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-20" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" source="mQhvSbKUOAa_Gd-00jPE-13" target="mQhvSbKUOAa_Gd-00jPE-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-13" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;while(directByteBuffer.hasRemaining()&lt;/span&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;directByteBuffer.get()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;hasRemaining()判断是否 position &amp;lt; limit&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="20" y="900" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-17" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;directByteBuffer.clear()&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;只是重置postion和limit索引，并没有清数据&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="40" y="980" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-19" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;unsafe.getByte(ix(nextGetIndex()))&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="900" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-21" value="&lt;font style=&quot;font-size: 10px&quot;&gt;&lt;div&gt;limit = position;&lt;/div&gt;&lt;div&gt;position = 0;&lt;/div&gt;&lt;div&gt;mark = -1;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="240" y="820" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="mQhvSbKUOAa_Gd-00jPE-23" value="HeapByteBuffer则是创建了个byte数组：byte[] hb" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="5ruEhwhexM6jTpCP8odR-1" vertex="1">
          <mxGeometry x="620" y="390" width="230" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
